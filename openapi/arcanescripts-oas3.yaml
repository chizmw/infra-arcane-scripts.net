---
openapi: 3.0.0
info:
  title: Arcane Scripts API
  description: API for requesting and retrieving rendered scripts
  version: v0.0.2
paths:
  /scripts:
    post:
      description: Post a request for a new script to be rendered
      parameters: []
      responses:
        '501':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ScriptTopLevelResponse'
      x-amazon-apigateway-integration:
        uri: ${post_lambda_arn}
        passthroughBehavior: when_no_match
        httpMethod: POST
        type: aws_proxy

  /scripts/{request_id}:
    get:
      description: Retrieve the status of a script request
      parameters:
        - name: request_id
          in: path
          description: The id of the script request
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ScriptResponse'
      x-amazon-apigateway-integration:
        uri: ${get_lambda_arn}
        passthroughBehavior: when_no_match
        httpMethod: POST
        type: aws_proxy

servers:
  - description: API Gateway (alpha)
    url: https://tgmospc50f.execute-api.eu-west-2.amazonaws.com/alpha
  - url: https://virtserver.swaggerhub.com/chizovation/CodingTips/0.0.1
components:
  schemas:
    CodingTip:
      type: object
      description: A coding tip
      properties:
        tip:
          type: string
          description: The coding tip
        date:
          type: number
          description: date in millis when tip was entered
        author:
          type: string
          description: Author of the coding tip
        category:
          type: string
          description: category of the coding tip
      required:
        - tip
    # types
    RequestId:
      type: string
      nullable: false
      example: 057a3874-625a-41f0-a89a-50799e535f44

    Status:
      type: string
      nullable: false
      enum: [received, processing, complete, failed]
      example: processing

    DownloadURL:
      type: string
      nullable: true
      example: https://somewhere.in.aws/b4f7-4d4acce98986.pdf

    # responses

    ScriptResponse:
      type: object
      properties:
        request_id:
          $ref: '#/components/schemas/RequestId'
        status:
          $ref: '#/components/schemas/Status'
        download_url:
          $ref: '#/components/schemas/DownloadURL'

    ScriptTopLevelResponse:
      type: object
      properties:
        message:
          type: string
          nullable: false
          example: we didn't write this yet
        request_id:
          $ref: '#/components/schemas/RequestId'
        status:
          $ref: '#/components/schemas/Status'
